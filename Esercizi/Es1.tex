\begin{alphaparts}
    %-------------------------------------A---------------------------------------
   \questionpart
   Date le seguenti funzioni di utilità per ciascun giocatore:
   \[
    u_i(x)=- \frac{x_i^2}{2}+ c_i x_i + \beta \sum\limits_{j \neq i} W_{ij}x_j x_i 
    \]
    trovare le funzioni di \textit{Best Response} per ciascun giocatore significa trovare le seguenti:

    \[BR_i(x_{ - i}) = \arg\max_{x_i \in \mathcal{A}} u_i(x_i, x_{ - i}).\]

    Poiché \(u_i(x)\) è concava rispetto a \(x_i\), trovare punti stazionari rispetto a \(x_i\) significa trovare massimi globali:
    \[
        \frac{\delta u_i ( x )}{\delta x_i} = -x_i + c_i + \beta  \sum \limits_{j \neq i}^{} W_{ij} x_j
    \]
    \[
        \frac{\delta u_i ( x )}{\delta x_i} = 0 \quad \iff \quad x_i = c_i + \beta  \sum \limits_{j \neq i}^{} W_{ij} x_j
    .\]
    Pertanto:
    \[
        BR_i(x_{-i}) = c_i + \beta  \sum \limits_{j \neq i}^{} W_{ij}x_j 
    .\]

    %------------------------------B----------------------------------------------
    \questionpart
    Poichè il grafo è privo di self-loop, la matrice di adiacenza \(W\) non presenta elementi non nulli sulla diagonale. è pertanto possibile utilizzare la seguente espressione per gli equilibri di Nash:
    \begin{equation}\label{eq_nash}
        x^* = \beta W x^* + c
    .\end{equation}
    Quindi, in forma esplicita, abbiamo:
    \begin{equation*}
        x^* = (I -\beta W)^{-1} c
    .\end{equation*}
    Questo significa che esistenza ed unicità di eventuali equilibri di Nash dipendono dalla singolarità della matrice \((I - \beta W)\): se l'inversa della matrice \((I - \beta W)\) esiste ed è unica, allora esiste ed è unico l'equilibrio di Nash \(x^*\) associato .

    DA INDAGARE SE ESISTONO CASI IN CUI L'EQUILIBRIO NON è UNICO

    La condizione:
    \begin{equation}\label{eq_condition_beta}
        \beta \omega_i < 1 \quad \quad \quad \forall i \in \mathcal{V}
    \end{equation}
    impone che le righe della matrice \(\beta W\) sommino ad una quantità strettamente minore di 1. La matrice \(\beta W\) si dice pertanto essere \textit{substocastica} e il suo raggio spettrale soddisfa la condizione \(\rho(\beta W) < 1\). Può quindi essere applicato il \textit{Criterio di Neumann} che ci assicura esistenza ed unicità della matrice \((I - \beta W)^{-1}\). In particolare vale:
    \begin{equation}
        (I-\beta W)^{-1} =  \sum \limits_{k=0}^{\infty} \beta^k W^k
    \end{equation}

    %-----------------------------C----------------------------------
    \questionpart
    Come visto per il punto precedente, se esiste ed è unico, l'equilibrio di Nash del gioco è dato da:
    \[
        x^* = (I -\beta W)^{-1} c
        \]
    pertanto è nella forma \(x^* = Mc\) e dipende linearmente dal vettore c. Nel caso in cui valga \ref{eq_condition_beta} allora, per il \textit{criterio di Neumann} abbiamo:
    \begin{equation} \label{eq_neumann}
        M =  \sum \limits_{k=0}^{\infty} \beta^k W^k
    .\end{equation}
    Inoltre vale:
    \begin{equation*}
        (W^k)_{ij} = \text{ \# di path da i a j di lunghezza k} \implies (W^k)_{ij} \geq 0 \quad \forall i, j \in \mathcal{V}
    \end{equation*}
    Pertanto \(M\) è dato dalla somma di matrici con elementi tutti non negativi:
    \[M_{ij} \geq 0 \quad \quad \forall i, j \in \mathcal{V}\]

    %-----------------------------D-------------------------------------------
    \questionpart
    Il vettore di centralità di Katz del grafo è dato da:
    \begin{equation*}
        z = \left(I - \left(\frac{1-\beta_K}{\lambda_W}\right)W'\right)^{-1}\beta_K \mu
    \end{equation*}
    Abbiamo quindi il seguente risultato:
    \[
    z'c = \left(\left(I - \frac{1 - \beta_K}{\lambda_W}W'\right)^{-1} \beta_K \mu\right)' c = \beta_k \mu' \left(I - \frac{1 - \beta_K}{\lambda_W}W\right)^{-1}c    
    \]
    Ponendo quindi \footnote{L'operazione è lecita dal momento che  la matrice \(\beta W\) è substocastica. Questo vuol dire che \(\rho(\beta W) = \beta \rho(W) < 1\), pertanto \(\beta_K \in [0,1]\).}
    \[ \frac{1 - \beta_K}{\lambda_W} = \beta \iff \beta_K = 1 - \lambda_W \beta \]
    e
    \[\mu = \frac{1}{1 - \lambda_W \beta} \mathbbm{1}\]
    si ottiene un vettore di centralità di Katz:
    
    \begin{equation}\label{eq_zhat}
        \hat{z} =\left(I - \beta W'\right)^{-1}\mathbbm{1}
    \end{equation}
    tale per cui:
    
    \begin{equation}\label{eq_yscalar}
        \hat{z}'c = \mathbbm{1}' (I - \beta W)^{-1} c =  \sum \limits_{j \in \mathbb{V}}^{} x^*_j = y.
    \end{equation}

    %-------------------------E---------------------------------------------
    \questionpart
    Vale il seguente risultato:
    \[
    Var(y) = Var(\hat{z}'c) = \hat{z}'VarCov(c)\hat{z}    
    \]
    Essendo il vettore \(c\) un vettore di variabili aleatorie indipendenti:
    \[
    Varcov(c) = \begin{bmatrix}
        \sigma_1^2 & & 0 \\
         & \ddots & \\
         0 & & \sigma_n^2
    \end{bmatrix}    
    \]
    Pertanto vale:
    \[Var(y) =  \sum \limits_{i = 1}^{n} \hat{z}_i^2 \sigma_i^2 =  \sum \limits_{i = 1}^{n} ((I - \beta W')^{-1}\mathbbm{1})_i^2 \sigma_i^2\]

    %-----------------------F-------------------------------------------------
    \questionpart
    Sia \(i_K\) il key player del gioco e sia \(W^{(- i_K)}\) la matrice di adiacenza del grafo \(\mathcal{G}^{(- i_K)}\) privato del nodo \(i_K\). Poiché la funzione di utility di ciascun nodo rimane invariata nella forma, si possono applicare gli stessi ragionamenti dei punti precedenti per trovare che esiste ed è unico l'equilibrio di Nash:
    \[
    x^{*(- i_K)} = (I- \beta W^{(- i_K)})^{- 1}c  
    \]
    per tutte le \(\beta\) che soddisfano \ref{eq_condition_beta} dal momento che la matrice \(\beta W^{(- i_K)}\) risulta substocastica. Se definiamo \(M^{(- i_K)} = (I- \beta W^{(- i_K)})^{- 1}\) allora, poiché \(c= \mathbbm{1}\), abbiamo: 
    \begin{equation}    
            x^{*(- i_K)} = M^{(- i_K)} \mathbbm{1}
    \end{equation}
    
    %-----------------G-----------------------------------------------------
    \questionpart
    Per ogni \(k \neq i \neq j\) vale:
    \begin{gather*}
        M_{ij}M_{ik} = M_{ii}(M_{ij}-M_{ij}^{(-i)}).
    \end{gather*}

    %--------------------------H--------------------------------------------
    \questionpart
    Poichè il gioco è simmetrico, da \ref{eq_zhat}, si ottiene che 
    \begin{equation}
        \hat{z} =\left(I - \beta W\right)^{-1}\mathbbm{1} = M\mathbbm{1}
    \end{equation}
    Notiamo inoltre da \ref{eq_neumann} che se il gioco è simmetrico allora anche la matrice \(M\) sarà simmetrica. Utilizzando quindi \ref{eq_yscalar} si ottiene:
    \begin{equation}
        y = \hat{z}' c = (M\mathbbm{1})'\mathbbm{1} = \mathbbm{1}' M \mathbbm{1} =  \sum \limits_{j}  \sum \limits_{k}^{} M_{jk} 
    \end{equation}
    e, analogamente
    \[
    y^{(- i)} = \mathbbm{1}' M^{(- i)} \mathbbm{1} = \sum \limits_{j\neq i}  \sum \limits_{k \neq i}^{} M_{jk}^{(- i)}
    .\]
    A questo punto si ottiene:
    \[
    y- y^{(- i)} =   \sum \limits_{j}  \sum \limits_{k}^{} M_{jk} - \sum \limits_{j\neq i}  \sum \limits_{k \neq i}^{} M_{jk}^{(- i)} =
    \]
    \[
    =  \left(\sum \limits_{j\neq i}  \sum \limits_{k \neq i}  M_{jk} -  M_{jk}^{(- i)} \right)+  \left(\sum \limits_{k \neq i}^{} M_{ik}\right) +  \left(\sum \limits_{j\neq i}^{} M_{ji} \right)+ M_{ii}
    \]
    Utilizzando il punto (g): \( (M_{ij}-M_{ij}^{(-i)}) = (M_{ij}M_{ik})/M_{ii}\) pertanto \footnote{Questo passaggio è sempre possibile in quanto \(M_{ii} > 0 \quad \forall i \in \mathcal{V}\). Infatti, essendo il grafo simmetrico, abbiamo che \((W^2)_{ii} > 0 \quad \forall i \in \mathcal{V}\). Il risultato segue dalla definizione di \(M\) e dal risultato ottenuto attraverso il criterio di Neumann. }

    \[
    y - y^{(- i)} = \left(\sum \limits_{j\neq i}  \sum \limits_{k \neq i} \frac{M_{ij}M_{ik}}{M_{ii}}\right) +   2 \left(  \sum \limits_{j \neq i}^{} M_{ij}\right) + M_{ii} =   
    \]
    \[
    = \frac{1}{M_{ii}} \left(\sum \limits_{j\neq i}  \sum \limits_{k \neq i} M_{ij}M_{ik}\right) + 2 \left(  \sum \limits_{j}^{} M_{ij}\right) - M_{ii} =
    \]
    \[
        =\frac{1}{M_{ii}} \left(  \sum \limits_{j\neq i}^{} M_{ij}  \sum \limits_{k}^{} M_{ik}- M_{ii} \sum \limits_{j\neq i}^{} M_{ij}\right) + 2 \left(  \sum \limits_{j}^{} M_{ij}\right) - M_{ii}
    \]
    Ora, poiché \(z_i =  \sum \limits_{j}^{} M_{ij}\) e \(  \sum \limits_{j \neq i}^{} M_{ij} = z_i - M_{ii}\), otteniamo:
    \[
        y - y^{(- i)} =  \frac{1}{M_{ii}} \left( \sum \limits_{j\neq i}^{} M_{ij} (z_i - M_{ii})\right) + 2z_i - M_{ii} = 
    \]
    \[
    =   \frac{1}{M_{ii}} (z_i - M_{ii})^2 + 2z_i - M_{ii} = \frac{z_i^2}{M_{ii}}  
    \]
    Pertanto il \textit{key player} è quel giocatore \(i\) che massimizza il rapporto \(\frac{z_i^2}{M_{ii}}.\)
\end{alphaparts}